<!-- 0xdA97d6D4403F1F2AdACCf8e8B485E4b3B6490B8d hash contract address -->

<!-- 0x86486Ba8DA4fAa866cA4203ecbFed5f951EE157a contract address -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Owner Contract Interaction</title>
</head>
<body>
    <h1>Owner Contract Interaction</h1>
   
    <input id="c1" type="text" placeholder="choose number (uint8)" value="" required>
    <input id="salt" type="text" placeholder="salt (uint8)" value="" required>
    <button  onclick="hash()">hash</button>
   <br>
   <br>

   <input id="c1Hash" type="text" placeholder="bytes32" value="" required>
   <input id="player2" type="text" placeholder="address" value="" required>
   <input id="stake" type="number" placeholder="add stake ETH" value="" required>
   <button  onclick="RPS()">deploy</button>
<br>
<br>
   <button  onclick="j1()">j1</button>
   <button  onclick="j2()">j2</button>
   <button  onclick="stake()">stake</button>
   <br>
   <br>
 

   <input id="move" type="number" placeholder="move (uint8)" value="" required>
   <input id="saltSolve" type="number" placeholder="salt (uint8)" value="" required>
   <button  onclick="solve()">solve</button>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.10.0/web3.min.js"></script>
    <script>
 const contractAddressHash = '0xdA97d6D4403F1F2AdACCf8e8B485E4b3B6490B8d';

const contractABIHash = [
	{
		"constant": true,
		"inputs": [
			{
				"name": "_c",
				"type": "uint8"
			},
			{
				"name": "_salt",
				"type": "uint256"
			}
		],
		"name": "hash",
		"outputs": [
			{
				"name": "",
				"type": "bytes32"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	}
]
const web3 = new Web3(window.ethereum);
const contractHash = new web3.eth.Contract(contractABIHash, contractAddressHash);

async function hash() {
    const c1=document.getElementById('c1').value;
    const salt = document.getElementById('salt').value;
try {
  console.log(c1);
const hasher= await contractHash.methods.hash(c1,salt).call();
console.log(hasher);
console.log("0xc258Ac72a022f45a99827506610Bf430C1709b98");
} catch (error) {
console.log('error');
}
}


//         /////////////////////////////////////////////////////////////////////////////
        let contractAddress;
		let hello;

        const contractABI = [
	{
		"constant": true,
		"inputs": [
			{
				"name": "_c1",
				"type": "uint8"
			},
			{
				"name": "_c2",
				"type": "uint8"
			}
		],
		"name": "win",
		"outputs": [
			{
				"name": "w",
				"type": "bool"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "j2Timeout",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "stake",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "c2",
		"outputs": [
			{
				"name": "",
				"type": "uint8"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "c1Hash",
		"outputs": [
			{
				"name": "",
				"type": "bytes32"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_c2",
				"type": "uint8"
			}
		],
		"name": "play",
		"outputs": [],
		"payable": true,
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "j2",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "lastAction",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_c1",
				"type": "uint8"
			},
			{
				"name": "_salt",
				"type": "uint256"
			}
		],
		"name": "solve",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "j1",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "j1Timeout",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "TIMEOUT",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"name": "_c1Hash",
				"type": "bytes32"
			},
			{
				"name": "_j2",
				"type": "address"
			}
		],
		"payable": true,
		"stateMutability": "payable",
		"type": "constructor"
	}
]
     
         let contract ;

       async function RPS() {
		const c1Hash=document.getElementById('c1Hash').value;
    const player2 = document.getElementById('player2').value
	const stake = document.getElementById('stake').value
	contractAddress=  "0x3C19E01f93a941D47304A0284713Cea24D42f509";
	contract=new web3.eth.Contract(contractABI, contractAddress);
        try {
                const accounts = await web3.eth.getAccounts();
                const playerAddress = accounts[0];
				console.log(accounts);
                
                const tx = await contract.deploy({ data: '608060405261012c600555604051604080610aaf833981018060405281019080805190602001909291908051906020019092919050505034600481905550336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555080600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555081600281600019169055504260068190555050506109ce806100e16000396000f3006080604052600436106100ba576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680630c4395b9146100bf578063294914a4146101145780633a4b66f11461012b57806348e257cb146101565780634d03e3d21461018f57806353a04b05146101c257806380985af9146101e557806389f71d531461023c578063a5ddec7c14610267578063c37597c6146102a1578063c8391142146102f8578063f56f48f21461030f575b600080fd5b3480156100cb57600080fd5b506100fa600480360381019080803560ff169060200190929190803560ff16906020019092919050505061033a565b604051808215151515815260200191505060405180910390f35b34801561012057600080fd5b50610129610403565b005b34801561013757600080fd5b506101406104ae565b6040518082815260200191505060405180910390f35b34801561016257600080fd5b5061016b6104b4565b6040518082600581111561017b57fe5b60ff16815260200191505060405180910390f35b34801561019b57600080fd5b506101a46104c7565b60405180826000191660001916815260200191505060405180910390f35b6101e3600480360381019080803560ff1690602001909291905050506104cd565b005b3480156101f157600080fd5b506101fa6105c0565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561024857600080fd5b506102516105e6565b6040518082815260200191505060405180910390f35b34801561027357600080fd5b5061029f600480360381019080803560ff169060200190929190803590602001909291905050506105ec565b005b3480156102ad57600080fd5b506102b66108c7565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561030457600080fd5b5061030d6108ec565b005b34801561031b57600080fd5b5061032461099c565b6040518082815260200191505060405180910390f35b600081600581111561034857fe5b83600581111561035457fe5b141561036357600090506103fd565b6000600581111561037057fe5b83600581111561037c57fe5b141561038b57600090506103fd565b600282600581111561039957fe5b8115156103a257fe5b0660028460058111156103b157fe5b8115156103ba57fe5b0614156103e1578160058111156103cd57fe5b8360058111156103d957fe5b1090506103fd565b8160058111156103ed57fe5b8360058111156103f957fe5b1190505b92915050565b6000600581111561041057fe5b600360009054906101000a900460ff16600581111561042b57fe5b14151561043757600080fd5b600554600654014211151561044b57600080fd5b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc6004549081150290604051600060405180830381858888f19350505050506000600481905550565b60045481565b600360009054906101000a900460ff1681565b60025481565b600060058111156104da57fe5b600360009054906101000a900460ff1660058111156104f557fe5b14151561050157600080fd5b6000600581111561050e57fe5b81600581111561051a57fe5b1415151561052757600080fd5b6004543414151561053757600080fd5b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561059357600080fd5b80600360006101000a81548160ff021916908360058111156105b157fe5b02179055504260068190555050565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60065481565b600060058111156105f957fe5b82600581111561060557fe5b1415151561061257600080fd5b6000600581111561061f57fe5b600360009054906101000a900460ff16600581111561063a57fe5b1415151561064757600080fd5b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156106a257600080fd5b600254600019168282604051808360058111156106bb57fe5b60ff167f01000000000000000000000000000000000000000000000000000000000000000281526001018281526020019250505060405180910390206000191614151561070757600080fd5b61072082600360009054906101000a900460ff1661033a565b15610786576000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc6004546002029081150290604051600060405180830381858888f19350505050506108bb565b61079f600360009054906101000a900460ff168361033a565b1561080657600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc6004546002029081150290604051600060405180830381858888f19350505050506108ba565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc6004549081150290604051600060405180830381858888f1935050505050600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc6004549081150290604051600060405180830381858888f19350505050505b5b60006004819055505050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600060058111156108f957fe5b600360009054906101000a900460ff16600581111561091457fe5b1415151561092157600080fd5b600554600654014211151561093557600080fd5b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc6004546002029081150290604051600060405180830381858888f19350505050506000600481905550565b600554815600a165627a7a72305820bcfed5d8cfb9ca5d0262e26fca552a9fdd2a240dc67d984366447b1957a3b64a0029',
                 arguments: [c1Hash, player2] })
                    .send({ from: playerAddress, value: web3.utils.toWei(stake, 'ether') });
             hello=tx._address
			 contractAddress=tx._address
			 contract= new web3.eth.Contract(contractABI, contractAddress);
                console.log(tx);
				console.log(hello);
				console.log(contract);
				console.log(`http://127.0.0.1:5500/path/player2.html?id=${contractAddress}`)
				
            } catch (error) {
                console.error(error);
            }
        }

		async function play() {
			const stake = document.getElementById('stake').value
        try {
                const accounts = await web3.eth.getAccounts();
				console.log(accounts);
                const playerAddress = accounts[0];
				const aa=2;
                
           const c2= await contract.methods.play(aa).send({ from: playerAddress, value: web3.utils.toWei(stake, 'ether') });
		   console.log(c2);
            } catch (error) {
                console.error(error);
            }
        }

		async function j1() {
			
        try {
                
                
           const j1= await contract.methods.j1().call()
		   console.log(j1);
            } catch (error) {
                console.error(error);
            }
        }
		
		async function j2() {
			
        try {
           const j2= await contract.methods.j2().call()
		   console.log(j2);
            } catch (error) {
                console.error(error);
            }
        }

		async function stake() {

			
			try {
			   const stake= await contract.methods.stake().call()
			   console.log("Current Stake:", web3.utils.fromWei(stake, 'ether'), "Ether");
				} catch (error) {
					console.error(error);
				}
			}

			async function solve() {
				const move=document.getElementById('move').value;
    const salt = document.getElementById('saltSolve').value;
				try {
					const accounts = await web3.eth.getAccounts();
				console.log(accounts);
                const playerAddress = accounts[0];
   const solvec1= await contract.methods.solve(move,salt).send({ from: playerAddress});
   console.log(solvec1);
	} catch (error) {
		console.error(error);
	}
}
    </script>
</body>
</html>
